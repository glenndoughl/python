import os
import requests
from cs50 import SQL
import datetime
import time


api_key = os.environ.get("OPENWEATHER_API_KEY")

cities = ['Aborlan', 'Abra De Ilog', 
          'Abucay', 'Abulug', 'Abuyog', 'Adams', 'Agdangan', 'Aglipay', 'Agno', 'Agoncillo', 'Agoo', 'Aguilar', 'Aguinaldo', 'Agutaya', 'Ajuy', 'Alabat', 'Alabel', 'Alamada', 'Alaminos', 'Alangalang', 'Albuera', 'Alburquerque', 'Alcala', 'Alcantara', 'Alcoy', 'Alegria', 'Aleosan', 'Alfonso', 'Alfonso Castaneda', 'Alfonso Lista', 'Aliaga', 'Alicia','Alilem', 'Alimodian', 'Alitagtag', 'Allacapan', 'Allen', 'Almagro', 'Almeria', 'Aloguinsan', 'Aloran', 'Altavas', 'Alubijid', 'Amadeo', 'Ambaguio', 'Amlan', 'Ampatuan', 'Amulung', 'Anahawan', 'Anao', 'Anda', 'Angadanan', 'Angat', 'Angono', 'Anilao', 'Anini-Y', 'Antequera', 'Antipas', 'Antipolo', 'Apalit', 'Aparri', 'Araceli', 'Arakan', 'Arayat', 'Argao', 'Aringay', 'Aritao', 'Aroroy', 'Arteche', 'Asingan', 'Asipulo', 'Asturias', 'Asuncion', 'Atimonan', 'Atok', 'Aurora', 'Ayungon', 'Baao', 'Babatngon', 'Bacacay', 'Bacarra', 'Baclayon', 'Bacnotan', 'Baco', 'Bacolod', 'Bacolod', 'Bacolor', 'Bacong', 'Bacuag', 'Bacungan', 'Badian', 'Badiangan', 'Badoc', 'Bagabag', 'Bagac', 'Bagamanoc', 'Baganga', 'Baggao', 'Bagulin', 'Bagumbayan', 'Bakun', 'Balabac', 'Balabagan', 'Balagtas', 'Balamban', 'Balanga', 'Balangiga', 'Balangkayan', 'Balaoan', 'Balasan', 'Balatan', 'Balayan', 'Balbalan', 'Baleno', 'Baler', 'Balete', 'Baliangao', 'Baliguian', 'Balilihan', 'Balindong', 'Balingasag', 'Balingoan', 'Baliuag', 'Ballesteros', 'Baloi', 'Balud', 'Balungao', 'Bamban', 'Bambang', 'Banate', 'Banaue', 'Banaybanay', 'Banayoyo', 'Banga', 'Bangar', 'Bangued', 'Bangui', 'Bani', 'Banisilan', 'Banna', 'Bansalan', 'Bansud', 'Bantay', 'Bantayan', 'Banton', 'Baras', 'Barbaza', 'Barcelona', 'Barili', 'Barira', 'Barlig', 'Barobo', 'Barotac Nuevo', 'Barotac Viejo', 'Baroy', 'Barugo', 'Basay', 'Basco', 'Basey', 'Basilisa', 'Basista', 'Basud', 'Batad', 'Batan', 'Batangas', 'Bataraza', 'Bato', 'Batuan', 'Bauan', 'Bauang', 'Bauko', 'Baungon', 'Bautista', 'Bay', 'Bayabas', 'Bayambang', 'Bayog', 'Bayombong', 'Belison', 'Benito Soliven', 'Besao', 'Bien Unido', 'Bilar', 'Biliran', 'Binalbagan', 'Binalonan', 'Binangonan', 'Bindoy', 'Bingawan', 'Binidayan', 'Binmaley', 'Binuangan', 'Biri', 'Boac', 'Bobon', 'Bocaue', 'Bokod', 'Bolinao', 'Boliney', 'Boljoon', 'Bombon', 'Bongabon', 'Bongabong', 'Bongao', 'Bonifacio', 'Bontoc', 'Bontoc', 'Borbon', 'Borongan', 'Boston', 'Botolan', 'Braulio E. Dujali', "Brooke'S Point", 'Bucay', 'Bucloc', 'Buenavista', 'Bugallon', 'Bugasong', 'Buguey', 'Buguias', 'Buhi', 'Bula', 'Bulacan', 'Bulalacao', 'Bulan', 'Buldon', 'Buluan', 'Bulusan', 'Bunawan', 'Burauen', 'Burdeos', 'Burgos', 'Buruanga', 'Bustos', 'Busuanga', 'Butuan', 'Buug', 'Caba', 'Cabagan', 'Cabangan', 'Cabanglasan', 'Cabarroguis', 'Cabatuan', 'Cabiao', 'Cabucgayan', 'Cabugao', 'Cabusao', 'Cagayan De Oro', 'Cagayancillo', 'Cagdianao', 'Cagwait', 'Caibiran', 'Cainta', 'Cajidiocan', 'Calabanga', 'Calaca', 'Calamba', 'Calanasan', 'Calapan', 'Calape', 'Calasiao', 'Calatagan', 'Calatrava', 'Calauag', 'Calauan', 'Calbiga', 'Calinog', 'Calintaan', 'Calubian', 'Calumpit', 'Caluya', 'Camalaniugan', 'Camalig', 'Camaligan', 'Camiling', 'Can-Avid', 'Canaman', 'Candaba', 'Candelaria', 'Candijay', 'Candoni', 'Cantilan', 'Caoayan', 'Capalonga', 'Capas', 'Capoocan', 'Caraga', 'Caramoan', 'Caramoran', 'Carasi', 'Cardona', 'Carigara', 'Carles', 'Carmen', 'Carmona', 'Carranglan', 'Carrascal', 'Casiguran', 'Castilla', 'Castillejos', 'Cataingan', 'Catanauan', 'Catarman', 'Catarman', 'Catbalogan', 'Cateel', 'Catigbian', 'Catmon', 'Catubig', 'Cauayan', 'Cavinti', 'Cawayan', 'Cebu', 'Cervantes', 'City of Alaminos', 'City of Angeles', 'City of Bacoor', 'City of Bago', 'City of Baguio', 'City of Bais', 'City of Batac', 'City of Bayawan', 'City of Baybay', 'City of Bayugan', 'City of Bislig', 'City of Biñan', 'City of Bogo', 'City of Cabadbaran', 'City of Cabanatuan', 'City of Cabuyao', 'City of Cadiz', 'City of Calamba', 'City of Calbayog', 'City of Caloocan', 'City of Candon', 'City of Canlaon', 'City of Carcar', 'City of Cauayan', 'City of Cavite', 'City of Cotabato', 'City of Dagupan', 'City of Dapitan', 'City of Dasmariñas', 'City of Davao', 'City of El Salvador', 'City of Escalante', 'City of Gapan', 'City of General Santos', 'City of General Trias', 'City of Gingoog', 'City of Guihulngan', 'City of Himamaylan', 'City of Iligan', 'City of Imus', 'City of Iriga', 'City of Isabela', 'City of Kabankalan', 'City of La Carlota', 'City of Lapu-Lapu', 'City of Las Piñas', 'City of Ligao', 'City of Lipa', 'City of Makati', 'City of Malabon', 'City of Mandaluyong', 'City of Mandaue', 'City of Manila', 'City of Marikina', 'City of Meycauayan', 'City of Muntinlupa', 'City of Naga', 'City of Navotas', 'City of Olongapo', 'City of Ozamiz', 'City of Panabo', 'City of Parañaque', 'City of Pasig', 'City of Passi', 'City of Sagay', 'City of San Carlos', 'City of San Jose Del Monte', 'City of San Juan', 'City of San Pablo', 'City of San Pedro', 'City of Santa Rosa', 'City of Santiago', 'City of Silay', 'City of Sipalay', 'City of Sto. Tomas', 'City of Tabaco', 'City of Tacurong', 'City of Tagaytay', 'City of Taguig', 'City of Talisay', 'City of Tanauan', 'City of Tangub', 'City of Tanjay', 'City of Tayabas', 'City of Toledo', 'City of Urdaneta', 'City of Valencia', 'City of Valenzuela', 'City of Victorias', 'City of Zamboanga', 'Clarin', 'Claver', 'Claveria', 'Columbio', 'Compostela', 'Concepcion', 'Conner', 'Consolacion', 'Corcuera', 'Cordon', 'Cordova', 'Corella', 'Coron', 'Cortes', 'Cuartero', 'Cuenca', 'Culaba', 'Culasi', 'Culion', 'Currimao', 'Cuyapo', 'Cuyo', 'Daanbantayan', 'Daet', 'Dagami', 'Dagohoy', 'Daguioman', 'Dalaguete', 'Damulog', 'Danao', 'Danao City', 'Dangcagan', 'Danglas', 'Dao', 'Dapa', 'Daraga', 'Daram', 'Dasol', 'Datu Abdullah Sangki', 'Datu Anggal Midtimbang', 'Datu Blah T. Sinsuat', 'Datu Hoffer Ampatuan', 'Datu Odin Sinsuat', 'Datu Paglas', 'Datu Piang', 'Datu Salibo', 'Datu Saudi-Ampatuan', 'Datu Unsay', 'Dauin', 'Dauis', 'Del Carmen', 'Del Gallego', 'Delfin Albano', 'Diadi', 'Diffun', 'Digos', 'Dilasag', 'Dimasalang', 'Dimataling', 'Dimiao', 'Dinagat', 'Dinalungan', 'Dinalupihan', 'Dinas', 'Dingalan', 'Dingle', 'Dingras', 'Dipaculao', 'Diplahan', 'Dipolog', 'Dolores', 'Don Carlos', 'Don Marcelino', 'Don Victoriano Chiongbian', 'Donsol', 'Doña Remedios Trinidad', 'Duero', 'Dueñas', 'Dulag', 'Dumaguete', 'Dumalag', 'Dumalinao', 'Dumalneg', 'Dumangas', 'Dumanjug', 'Dumaran', 'Dumarao', 'Dumingag', 'Dupax del Norte', 'Echague', 'El Nido', 'Enrile', 'Enrique B. Magalona', 'Enrique Villanueva', 'Esperanza', 'Estancia', 'Famy', 'Ferrol', 'Flora', 'Floridablanca', 'Gabaldon', 'Gainza', 'Galimuyod', 'Gamay', 'Gamu', 'Gandara', 'Garchitorena', 'Garcia Hernandez', 'Gasan', 'Gattaran', 'Gen. Mariano Alvarez', 'Gen. S.K. Pendatun', 'General Emilio Aguinaldo', 'General Luna', 'General Macarthur', 'General Mamerto Natividad', 'General Nakar', 'General Tinio', 'Gerona', 'Getafe', 'Gigaquit', 'Gigmoto', 'Ginatilan', 'Giporlos', 'Gitagum', 'Glan', 'Gloria', 'Goa', 'Godod', 'Gonzaga', 'Governor Generoso', 'Gregorio del Pilar', 'Guagua', 'Gubat', 'Guiguinto', 'Guimba', 'Guimbal', 'Guinayangan', 'Guindulman', 'Guindulungan', 'Guinobatan', 'Guinsiliban', 'Guipos', 'Guiuan', 'Gumaca', 'Gutalac', 'Hadji Mohammad Ajul', 'Hagonoy', 'Hamtic', 'Hermosa', 'Hernani', 'Hilongos', 'Hinabangan', 'Hinatuan', 'Hindang', 'Hingyon', 'Hinigaran', 'Hinoba-an', 'Hinunangan', 'Hinundayan', 'Hungduan', 'Iba', 'Ibaan', 'Ibajay', 'Igbaras', 'Iguig', 'Ilagan', 'Ilog', 'Iloilo', 'Imelda', 'Impasug-ong', 'Inabanga', 'Indanan', 'Indang', 'Infanta', 'Initao', 'Inopacan', 'Ipil', 'Irosin', 'Isabel', 'Isabela', 'Island Garden City of Samal', 'Isulan', 'Itbayat', 'Itogon', 'Ivana', 'Ivisan', 'Jabonga', 'Jaen', 'Jagna', 'Jala-Jala', 'Jamindan', 'Janiuay', 'Jaro', 'Jasaan', 'Javier', 'Jiabong', 'Jimalalud', 'Jimenez', 'Jolo', 'Jomalig', 'Jones', 'Jordan', 'Jose Abad Santos', 'Jose Dalman', 'Jose Panganiban', 'Josefina', 'Jovellar', 'Juban', 'Julita', 'Kabacan', 'Kabasalan', 'Kabayan', 'Kabugao', 'Kabuntalan', 'Kadingilan', 'Kalamansig', 'Kalawit', 'Kalayaan', 'Kalibo', 'Kalilangan', 'Kananga', 'Kapalong', 'Kapangan', 'Kapatagan', 'Kasibu', 'Katipunan', 'Kauswagan', 'Kawayan', 'Kawit', 'Kayapa', 'Kiamba', 'Kiangan', 'Kibawe', 'Kiblawan', 'Kibungan', 'Kidapawan', 'Kinoguitan', 'Kitaotao', 'Kitcharao', 'Kolambugan', 'Koronadal', 'Kumalarang', 'La Castellana', 'La Libertad', 'La Paz', 'La Trinidad', 'Laak', 'Labangan', 'Labason', 'Labo', 'Labrador', 'Lacub', 'Lagangilang', 'Lagawe', 'Lagayan', 'Lagonglong', 'Lagonoy', 'Laguindingan', 'Lake Sebu', 'Lakewood', 'Lal-Lo', 'Lala', 'Lambayong', 'Lambunao', 'Lamitan', 'Lamut', 'Languyan', 'Lantapan', 'Lantawan', 'Lanuza', 'Laoac', 'Laoag', 'Laoang', 'Lapinig', 'Lapuyan', 'Larena', 'Las Navas', 'Las Nieves', 'Lasam', 'Laua-An', 'Laur', 'Laurel', 'Lavezares', 'Lawaan', 'Lazi', 'Lebak', 'Leganes', 'Legazpi', 'Lemery', 'Leon', 'Leyte', 'Lezo', 'Lian', 'Lianga', 'Libacao', 'Libagon', 'Libertad', 'Libjo', 'Libmanan', 'Libon', 'Libona', 'Libungan', 'Licab', 'Licuan-Baay', 'Lidlidda', 'Lila', 'Liliw', 'Liloan', 'Liloy', 'Limasawa', 'Limay', 'Linamon', 'Linapacan', 'Lingayen', 'Lingig', 'Llanera', 'Llorente', 'Loay', 'Lobo', 'Loboc', 'Looc', 'Loon', 'Lopez', 'Lopez Jaena', 'Loreto', 'Los Baños', 'Luba', 'Lubang', 'Lubao', 'Lubuagan', 'Lucban', 'Lucena', 'Lugait', 'Lugus', 'Luisiana', 'Lumban', 'Luna', 'Lupao', 'Lupi', 'Lupon', 'Lutayan', 'Luuk', "M'Lang", 'Ma-Ayon', 'Maasim', 'Maasin', 'Maasin', 'Mabalacat City', 'Mabinay', 'Mabini', 'Mabitac', 'Mabuhay', 'Macabebe', 'Macalelon', 'Macarthur', 'Maco', 'Macrohon', 'Madalag', 'Maddela', 'Madrid', 'Madridejos', 'Magalang', 'Magallanes', 'Magarao', 'Magdalena', 'Magdiwang', 'Magpet', 'Magsaysay', 'Magsingal', 'Mahaplag', 'Mahayag', 'Mahinog', 'Maigo', 'Maimbung', 'Mainit', 'Maitum', 'Majayjay', 'Makato', 'Makilala', 'Malabang', 'Malabuyoc', 'Malalag', 'Malangas', 'Malapatan', 'Malasiqui', 'Malay', 'Malaybalay', 'Malibcong', 'Malilipot', 'Malimono', 'Malinao', 'Malita', 'Malitbog', 'Mallig', 'Malolos', 'Malungon', 'Maluso', 'Malvar', 'Mamasapano', 'Mambajao', 'Mamburao', 'Mambusao', 'Manabo', 'Manaoag', 'Manapla', 'Manay', 'Mandaon', 'Mangaldan', 'Mangatarem', 'Manito', 'Manjuyod', 'Mankayan', 'Manolo Fortich', 'Mansalay', 'Manticao', 'Manukan', 'Mapanas', 'Mapandan', 'Mapun', 'Marabut', 'Maragondon', 'Maragusan', 'Maramag', 'Marantao', 'Marawi', 'Marcos', 'Margosatubig', 'Maria', 'Maria Aurora', 'Maribojoc', 'Marihatag', 'Marilao', 'Maripipi', 'Mariveles', 'Marogong', 'Masantol', 'Masbate', 'Masinloc', 'Mataasnakahoy', 'Matag-Ob', 'Matalam', 'Matalom', 'Matanao', 'Matanog', 'Mati', 'Matnog', 'Matuguinao', 'Mauban', 'Mawab', 'Mayantoc', 'Maydolong', 'Mayorga', 'Mayoyao', 'Medellin', 'Medina', 'Mendez', 'Mercedes', 'Merida', 'Mexico', 'Miagao', 'Midsalip', 'Midsayap', 'Milagros', 'Milaor', 'Mina', 'Minalabac', 'Minalin', 'Minglanilla', 'Moalboal', 'Mobo', 'Mogpog', 'Moises Padilla', 'Molave', 'Moncada', 'Mondragon', 'Monkayo', 'Monreal', 'Montevista', 'Morong', 'Motiong', 'Mulanay', 'Munai', 'Murcia', 'Mutia', 'Naawan', 'Nabas', 'Nabua', 'Nabunturan', 'Naga', 'Nagcarlan', 'Nagtipunan', 'Naguilian', 'Naic', 'Nampicuan', 'Narra', 'Narvacan', 'Nasipit', 'Nasugbu', 'Natividad', 'Natonin', 'Naujan', 'Naval', 'New Bataan', 'New Corella', 'New Lucena', 'New Washington', 'Norala', 'Norzagaray', 'Noveleta', 'Nueva Era', 'Nueva Valencia', 'Numancia', 'Oas', 'Obando', 'Ocampo', 'Odiongan', 'Olutanga', 'Omar', 'Opol', 'Orani', 'Oras', 'Orion', 'Ormoc City', 'Oroquieta', 'Oslob', 'Oton', 'Padada', 'Padre Burgos', 'Padre Garcia', 'Paete', 'Pagadian', 'Pagagawan', 'Pagalungan', 'Pagbilao', 'Paglat', 'Pagsanghan', 'Pagsanjan', 'Pagudpud', 'Pakil', 'Palanan', 'Palanas', 'Palapag', 'Palauig', 'Palayan', 'Palimbang', 'Palo', 'Palompon', 'Paluan', 'Pambujan', 'Pamplona', 'Panaon', 'Panay', 'Pandami', 'Pandan', 'Pandi', 'Panganiban', 'Pangantucan', 'Pangil', 'Panglao', 'Panglima Sugala', 'Pangutaran', 'Paniqui', 'Panitan', 'Pantabangan', 'Pantao Ragat', 'Pantar', 'Pantukan', 'Panukulan', 'Paoay', 'Paombong', 'Paracale', 'Paracelis', 'Paranas', 'Parang', 'Pasacao', 'Pasay City', 'Pasil', 'Pastrana', 'Pasuquin', 'Pateros', 'Patikul', 'Patnanungan', 'Patnongon', 'Pavia', 'Payao', 'Perez', 'Peñablanca', 'Peñaranda', 'Peñarrubia', 'Piat', 'Piddig', 'Pidigan', 'Pigkawayan', 'Pikit', 'Pila', 'Pilar', 'Pili', 'Pililla', 'Pinabacdao', 'Pinamalayan', 'Pinamungajan', 'Pinili', 'Pintuyan', 'Pinukpuk', 'Pio Duran', 'Pio V. Corpuz', 'Pitogo', 'Piñan', 'Placer', 'Plaridel', 'Pola', 'Polanco', 'Polangui', 'Polillo', 'Polomolok', 'Pontevedra', 'Porac', 'Poro', 'Pototan', 'Pozorrubio', 'Pres. Manuel A. Roxas', 'Presentacion', 'President Carlos P. Garcia', 'President Quirino', 'President Roxas', 'Prieto Diaz', 'Prosperidad', 'Pudtol', 'Puerto Galera', 'Puerto Princesa', 'Pugo', 'Pulilan', 'Pulupandan', 'Pura', 'Quezon', 'Quezon City', 'Quinapondan', 'Quirino', 'Ragay', 'Rajah Buayan', 'Ramon', 'Ramon Magsaysay', 'Ramos', 'Rapu-Rapu', 'Real', 'Reina Mercedes', 'Remedios T. Romualdez', 'Rizal', 'Rodriguez', 'Romblon', 'Ronda', 'Rosales', 'Rosario', 'Roseller Lim', 'Roxas', 'Roxas', 'Sabangan', 'Sablan', 'Sablayan', 'Sabtang', 'Sadanga', 'Sagada', 'Sagay', 'Sagbayan', 'Saguday', 'Saguiaran', 'Sagñay', 'Saint Bernard', 'Salay', 'Salcedo', 'Sallapadan', 'Salug', 'Salvador', 'Samal', 'Samboan', 'Sampaloc', 'San Agustin', 'San Andres', 'San Antonio', 'San Benito', 'San Clemente', 'San Dionisio', 'San Emilio', 'San Enrique', 'San Esteban', 'San Fabian', 'San Felipe', 'San Fernando', 'San Fernando', 'San Francisco', 'San Gabriel', 'San Guillermo', 'San Ildefonso', 'San Isidro', 'San Jacinto', 'San Joaquin', 'San Jorge', 'San Jose', 'San Jose', 'San Jose City', 'San Jose De Buan', 'San Juan', 'San Julian', 'San Leonardo', 'San Lorenzo', 'San Lorenzo Ruiz', 'San Luis', 'San Manuel', 'San Marcelino', 'San Mariano', 'San Mateo', 'San Miguel', 'San Narciso', 'San Nicolas', 'San Pablo', 'San Pascual', 'San Policarpo', 'San Quintin', 'San Rafael', 'San Remigio', 'San Ricardo', 'San Roque', 'San Sebastian', 'San Simon', 'San Teodoro', 'San Vicente', 'Sanchez-Mira', 'Santa', 'Santa Ana', 'Santa Barbara', 'Santa Catalina', 'Santa Cruz', 'Santa Cruz', 'Santa Elena', 'Santa Fe', 'Santa Ignacia', 'Santa Josefa', 'Santa Lucia', 'Santa Magdalena', 'Santa Marcela', 'Santa Margarita', 'Santa Maria', 'Santa Monica', 'Santa Praxedes', 'Santa Rita', 'Santa Rosa', 'Santa Teresita', 'Santander', 'Santiago', 'Santo Domingo', 'Santo Niño', 'Santo Tomas', 'Santol', 'Sapa-Sapa', 'Sapad', 'Sapang Dalaga', 'Sapi-An', 'Sara', 'Sarangani', 'Sariaya', 'Sarrat', 'Sasmuan', 'Science City of Muñoz', 'Sebaste', 'Sen. Ninoy Aquino', 'Sergio Osmeña Sr.', 'Sevilla', 'Shariff Aguak', 'Siasi', 'Siaton', 'Siay', 'Siayan', 'Sibagat', 'Sibalom', 'Sibonga', 'Sibuco', 'Sibulan', 'Sibunag', 'Sibutad', 'Sierra Bullones', 'Sigay', 'Sigma', 'Sikatuna', 'Silago', 'Silang', 'Simunul', 'Sinacaban', 'Sinait', 'Sindangan', 'Siniloan', 'Siocon', 'Sipocot', 'Siquijor', 'Sirawai', 'Siruma', 'Sison', 'Sitangkai', 'Socorro', 'Sofronio Española', 'Sogod', 'Solana', 'Solano', 'Solsona', 'Sominot', 'Sorsogon', 'South Ubian', 'South Upi', 'Sual', 'Subic', 'Sudipen', 'Sugbongcogon', 'Sugpon', 'Sulat', 'Sulop', 'Sultan Kudarat', 'Sultan Mastura', 'Sultan Naga Dimaporo', 'Sultan Sa Barongis', 'Sumilao', 'Sumisip', 'Surallah', 'Surigao', 'Suyo', "T'Boli", 'Taal', 'Tabango', 'Tabina', 'Tabogon', 'Tabontabon', 'Tabuelan', 'Tabuk', 'Tacloban', 'Tadian', 'Taft', 'Tagana-An', 'Tagapul-An', 'Tagbilaran', 'Tagbina', 'Tagkawayan', 'Tago', 'Tagoloan', 'Tagudin', 'Tagum', 'Talacogon', 'Talaingod', 'Talakag', 'Talalora', 'Talavera', 'Talayan', 'Talibon', 'Talipao', 'Talisay', 'Talisayan', 'Talitay', 'Talugtug', 'Talusan', 'Tambulig', 'Tampakan', 'Tamparan', 'Tampilisan', 'Tanauan', 'Tanay', 'Tandag', 'Tandubas', 'Tangalan', 'Tantangan', 'Tanudan', 'Tanza', 'Tapaz', 'Tarangnan', 'Tarlac', 'Tarragona', 'Tayasan', 'Taysan', 'Taytay', 'Tayug', 'Tayum', 'Teresa', 'Ternate', 'Tiaong', 'Tibiao', 'Tigaon', 'Tigbao', 'Tigbauan', 'Tinambac', 'Tinglayan', 'Tingloy', 'Tinoc', 'Titay', 'Tiwi', 'Tobias Fornier', 'Toboso', 'Tolosa', 'Tomas Oppus', 'Tongkil', 'Torrijos', 'Trece Martires', 'Trento', 'Trinidad', 'Tuao', 'Tuba', 'Tubajon', 'Tubao', 'Tubay', 'Tubigon', 'Tublay', 'Tubo', 'Tubod', 'Tubod', 'Tubungan', 'Tuburan', 'Tudela', 'Tuguegarao', 'Tukuran', 'Tulunan', 'Tumauini', 'Tunga', 'Tungawan', 'Tupi', 'Tuy', 'Ubay', 'Umingan', 'Ungkaya Pukan', 'Unisan', 'Upi', 'Urbiztondo', 'Uson', 'Uyugan', 'Valderrama', 'Valencia', 'Valladolid', 'Vallehermoso', 'Veruela', 'Victoria', 'Viga', 'Vigan', 'Villaba', 'Villanueva', 'Villareal', 'Villasis', 'Villaverde', 'Villaviciosa', 'Vincenzo A. Sagun', 'Vintar', 'Vinzons', 'Virac', 'Wao', 'Zamboanguita', 'Zaragoza', 'Zarraga', 'Zumarraga'
          ]

db = SQL("sqlite:///web.db")

while True:
    for city in cities:
        try:
            api_response = requests.get(f"https://api.openweathermap.org/data/2.5/weather?q={city}&appid={api_key}").json()
        except:
            continue
        
        if not api_response.get("name"):
            continue

        city = api_response.get("name")
        weather = api_response.get("weather")[0].get("main")
        description = api_response.get("weather")[0].get("description")
        temp_min = api_response.get("main").get("temp_min") - 273.15
        temp_max = api_response.get("main").get("temp_max") - 273.15
        lat = api_response.get("coord").get("lat")
        lon = api_response.get("coord").get("lon")
        humidity = api_response.get("main").get("humidity")
        date = datetime.datetime.fromtimestamp(int(api_response.get("dt"))).strftime("%Y-%m-%d")
        hour = datetime.datetime.fromtimestamp(int(api_response.get("dt"))).strftime("%H")
        db.execute(f"INSERT INTO weather_data (city, humidity, weather, description, temp_min, temp_max, lat, lon, date, hour) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?);", city, humidity, weather, description, temp_min, temp_max, lat, lon, date, hour)

    time.sleep(3600)


    
    
